<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Algoritmos e inteligencia artificial | Alejandro Pascual Hernández</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet">
  
  <meta 
    name="description" 
    content="Análisis detallado de expresión génica en cáncer de mama usando R y diferéntes técnicas de reducción de la dimensionalidad. Proyecto de portfolio de Alejandro Pascual."
  >

  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />

  <link rel="stylesheet" href="../../style-proyects.css" />
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.min.css">
  
</head>
<body>

  <header class="hero project-hero-short reveal">
    <div class="hero-content">
      <h1> Algoritmos e inteligencia artificial </h1>   
      <a href="../../../index.html" class="btn">Volver al inicio</a>
      <a href="../master.html" class="btn">Volver a las asignaturas</a>
    </div>
  </header>

  <main class="section">

    <div class="tech-stack-tags reveal">
      <span>R</span>
      <span>RStudio</span>
      <span>R Markdown</span>
      <span>MDS</span>
      <span>Isomap</span>
      <span>Umap</span>
      <span>Clustering</span>
    </div>

    <section class="reveal">
      <h2>Aplicación de técnicas de aprendizaje no supervisado sobre datos biológicos</h2>
      <p>
       El objetivo de esta actividad es determinar de forma justificada aquellos algoritmos 
        de aprendizaje no supervisado más eficientes a la hora de detectar patrones en el conjunto 
        de datos propuesto.En este caso el conjunto de unos datos sobre cancer.
      </p>
    </section>

    <section class="key-findings reveal">
      <h3>CONCLUSIONES CLAVE</h3>
      <p>
        El estudio estuvo dividido en tres apartados en los cuales se concluyó lo siguiente:
      </p>
      <ul>
        <li>
          <i class="fas fa-check-circle" aria-hidden="true"></i>
          <a href="#tarea-1-expresión-génica-según-el-tratamiento-aplicado-a-10-genes"><strong>Fármaco vs. Placebo</strong></a> se puede apreciar una diferencia significativa en la expresión de 10 genes de pacientes cuando estos has sido
          tratados con un fármaco o cuando se les ha dado placebo.
        </li>
        <li>
          <i class="fas fa-check-circle" aria-hidden="true"></i>
           <a href="#tarea-2-distribución-de-parámetros-bioquímicos-dentro-de-una-población"><strong>Diferencias en la distribución</strong></a> se observó como se distribuían los niveles de ciertos parámetros bioquímicos en una población y se 
          correlacionó con implicaciones biológicas como indicadores de enfermedad u otro tipo de condiciones. 
        </li>
        <li>
          <i class="fas fa-check-circle" aria-hidden="true"></i>
           <a href="#tarea-3-mapea-todos-los-valores-de-expresión-de-genes"><strong>Clasificación y agrupación de genes</strong></a> se estudió 30 genes de interés los cuales fueron agrupados en 3 clusters que presentaban los 
          mismos patrones de expresión entre nuestra muestra poblacional.
        </li>
      </ul>
    </section>

    <div class="r-markdown-container">
      
      <div id="pasos-previos" class="section level3">
        <h3>Pasos previos</h3>
        <p>En primer lugar, tenemos que cargar todas la librerías y datos que vamos a usar para el análisis de 
          datos. Por un lado, cargamos los datos de los de “data.csv” como una matriz en el que la fila 1 corresponde 
          a las muestras de nuestros pacientes y que debemos indiciar que en nuestra matriz no será una columna de genes 
          más sino la los nombres. “lebels.csv” corresponde a un data frame que asocia los nombres de estas muestras con el 
          tipo de cáncer que tiene el paciente al que corresponde esta muestra. </p>
        <pre><code class="r">library(plotly)
library(stats)
library(uwot)
library(RDRToolbox)
library(dplyr)
library(factoextra)
library(ggdendro)
library(cluster)
library(ggplot2) 
library(gridExtra)
library(pheatmap)
library(tidyr)

labels.raw<- read.csv('labels.csv')
data <- as.matrix(read.csv("data.csv", row.names = 1))</code></pre>
        <p>Como podemos ver en la matriz creada tenemos 801 muestras de pacientes y 20532 genes estudiados, lo cual nos lleva a 
          que haya un claro problema de dimensionalidad. Para solucionarlo debemos recurrir a distintas técnicas o herramientas que 
          nos permitan reducir todos estos datos a un nivel de dimensiones comprensibles e interpretables. Existen muchas es estas 
          técnicas que podemos utilizar, pero en esta actividad nos enfocaremos en 4 distintas que hemos escogido para enseñar diferentes 
          problemas que nos podemos encontrar a la hora de reducir la dimensionalidad. Iremos argumentando el porqué de nuestra elección 
          y como ha sido el tratamiento tanto de los datos como de los parámetros que se pueden modificar en cada método.</p>
      </div>
      <div id="mds" class="section level3">
        <h3>MDS</h3>
        <p>El primero de los métodos que decidimos utilizar es el MDS (multidimensional scaling, en español escalamiento multidimensional). 
          Se trata de un método en el cual se mide la distancia entre distintas muestras o puntos y los agrupa. Esta distancia puede ser medida
          de diferentes formas. Aunque nosotros en este caso decidimos usar la más común, la distancia euclidiana, también existen distancias como 
          la “de Manhattan”, “de Hamming”, etc. Este método nos permite seleccionar también el número de dimensiones en el que vamos a representar 
          nuestros resultados. En un principio los visualizaremos en 2 dimensiones. </p>
        <pre><code class="r">
  distances &lt; dist(data, method = 'euclidean') # matriz de distancias

mds.results &lt; cmdscale(d=distances, eig=TRUE, k=2, x.ret=TRUE) # La función cmdscale realiza el MSD

varianza.explicada &lt; mds.results$eig/sum(mds.results$eig) * 100 # varianza explicada

mds.df &lt; data.frame(mds.results$points) # convertimos los datos del mds en un data frame

ggplot(mds.df, aes(x=X1, y=X2, color=labels.raw$Class)) + #Por último graficamos
  geom_point(size=3) + 
  scale_color_manual(values=c("red", "blue", "green", "orange", "purple")) +
  labs(title="MDS - Types of Cancer", x="Dimension 1 (X1)", y="Dimension 2 (X2)", color = "Grupo") +
  theme_classic() + 
  theme(panel.grid.major = element_line(color = "gray90"), panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "gray95"), plot.title=element_text(hjust=0.5))
</code></pre>
        
        <figure class="r-plot-figure">
          <img src="fig1.png" alt="Fig. 1: MDS 2 dimensiones">
          <figcaption><em>Fig. 1: Representación gráfica de nuestros datos usando la técnica MDS en 2 dimensiones.</em></figcaption>
        </figure>

        <p>Como podemos ver en la representación gráfica existen muchos puntos que no están bien separados y aunque ya se pueden apreciar 
          nuestros 5 clusters de las 5 enfermedades diferentes, no creemos que esto sea una buena separación. Por este motivo decidimos intentar 
          visualizarlo en 3 dimensiones para comprobar si de esta manera podríamos diferenciar mejor los diferentes grupos.Para ello debemos
          cambiar el parámetro k, que equivale al número de dimensiones.</p>
         <pre><code class="r">mds_result <- cmdscale(distances, k = 3) # hacemos lo mismo pero para 3 dimensiones

mds_df <- as.data.frame(mds_result)
colnames(mds_df) &lt; c("Dim1", "Dim2", "Dim3")

mds_df$Cancer_Type &lt; labels.raw$Class # añadimos las etiquetas del cancer

fig &lt; plot_ly(mds_df, x = ~Dim1, y = ~Dim2, z = ~Dim3, #graficamos
               color = ~Cancer_Type, colors = "Set1", 
               marker = list(size = 4))

fig </code></pre>
        <figure class="r-plot-figure">
          <img src="fig2.png" alt="Fig. 1: MDS 3 dimensiones">
          <figcaption><em>Fig. 1: Representación gráfica de nuestros datos usando la técnica MDS en 3 dimensiones.</em></figcaption>
        </figure>
        <p>Visualizando los resultados en 3 dimensiones podemos ver más claramente los 5 grupos diferenciados. Esto es una manera muy 
          interesante de resolver el problema inicial, pero conlleva otra serie de desventajas. La primera y más evidente es que no 
          siempre podremos representar con graficas 3D pues no todos los medios los permiten y mucho menos si no son digitales. Otras 
          de las desventajas del MDS es que puede ser muy costoso computacionalmente ya que requiere calcular la distancia de cada uno 
          de los puntos entre ellos. </p>
      </div>
      
      <div id="isomap" class="section level3">
        <h3>Isomap</h3>
        <p>Como siguiente método vamos a utilizar uno relacionado con el anterior, el Isometric mapping (Isomap). Al igual que en el método 
          anterior se busca medir distancias entre puntos para realizar agrupaciones, pero en esta ocasión la distancia utilizada es la distancia 
          geodésica. Esta distancia se calcula sobre una superficie que cambia según sea la disposición del conjunto de datos. Esta disposición
          del conjunto de datos está determinada principalmente por lo que nosotros consideremos el número de vecinos próximos o K. 
          Este parámetro es el principal con el que jugaremos para obtener un mejor resultado a la hora de realizar agrupaciones. 
          En un principio el numero de K que usaremos será 5.</p>
        <pre><code class="r">set.seed(1234)

isomap.results = Isomap(data=data, dims=1:10, k=5, plotResiduals=FALSE) # isomap de 1 a 10 dimensiones y con 5 vecinos. Decidimos poner plotResiduals=FALSE para no observar la varianza expicada 

isomap.df &lt; data.frame(isomap.results$dim2) # Dataframe con los puntos que queremos dibujar en el plano 2D

ggplot(isomap.df, aes(x = X1, y = X2, color = labels.raw$Class)) +
  geom_point(size = 3) +
  scale_color_manual(values = c("red", "blue", "green", "orange", "purple")) +
  labs(title = "Isomap - Types of Cancer", x = 'Dim 1', y = 'Dim 2', color = "Grupo") +
  theme_classic() +
  theme(panel.grid.major = element_line(color = "gray90"), panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "gray95"), plot.title=element_text(hjust=0.5)) </code></pre>
        <p>Ahora tenemos que combinar dos tipos de gráficos, un histograma y uno
        de densidad.</p>
        <pre><code class="r">ggplot(
    data = datos_bio_long, 
    aes(x = valor) 
  ) +
    
    # Histograma
    geom_histogram(
      aes(y = after_stat(density)), 
      bins = 30,
      fill = "steelblue", 
      color = "black",
      alpha = 0.7
    ) +
    
    # Curva de Densidad
    geom_density(
      color = "red",
      linewidth = 1  
    ) +
    
    facet_wrap(
      ~ variable, 
      scales = "free" 
    ) +
    
    labs(
      title = "Distribución de Variables Bioquímicas",
      subtitle = "Histograma y Curva de Densidad",
      x = "Valores del parámetro (unidad dependiente de cada parámetro)",
      y = "Densidad"
    ) +
    theme_minimal()+
    theme(legend.position = "none",
          plot.title = element_text(size = 20, hjust = 0.5),    
      plot.subtitle = element_text(size = 17,hjust = 0.5),    
      axis.title.x = element_text(size = 17),
      axis.title.y = element_text(size = 17),
      axis.text = element_text(size = 11),
      strip.text = element_text(size = 12, face = "bold"))</code></pre>
        
        <figure class="r-plot-figure">
          <img src="img2.jpg" alt="Fig. 2: Histogramas de variables bioquímicas">
          <figcaption><em>Fig. 2: Histogramas con curvas de densidad de 12 parámetros
          bioquímicos distintos en una población de 65 pacientes.</em></figcaption>
        </figure>

        <p>Observando la graficas obtenidas podemos comprobar que hay diferentes
        tipos de distribución en una población dependiendo de los parámetros
        analizados. Por ejemplo, si miramos parámetros como la
        <strong>transferrina o el colesterol (chol)</strong> podríamos decir que
        se trata de una <strong>distribución normal o gaussiana, o una
        distribución t de student</strong>. Pero, por otra parte, algunos de los
        parámetros parecen seguir otro tipo de distribuciones como la
        <strong>chi cuadrado o la f de Fisher</strong>. Este es el caso de
        parámetros como cpk, trigliceridos, leucocitos, neutrófilos, iga, ige,
        ldl. Son distribuciones asimétricas que están claramente sesgadas hacia
        valores bajos. El caso más evidente es el del <strong>parámetro
        pcr</strong>.</p>
        <p>Por lo tanto, nos encontramos con dos claros tipos de parámetros
        bioquímicos. Por un lado, los parámetros que se encuentran distribuidos
        de una forma gaussiana son parámetros en los que la población suele
        tener ciertos niveles endógenos normales y niveles tanto muy bajos como
        muy altos se suelen considerar anormales o nocivos, indicando una
        posible enfermedad. Este podría ser el caso de la transferrina encargada
        del transporte del hierro cuyos niveles altos o bajos pueden estar
        relacionados con enfermedades y síntomas como la anemia y la
        hemocromatosis (exceso de hierro), respectivamente.</p>
        <p>Por otro lado, hay parámetros bioquímicos que tienden a quedarse en
        niveles bajos de forma constitutiva y solo aumentan cuando hay una
        alteración o enfermedad. Este es el caso, por ejemplo, del parámetro pcr
        (Proteína C Reactiva) que es una proteína liberada por el hígado en los
        procesos inflamatorios o en infecciones en el cuerpo. Normalmente los
        niveles de pcr son casi de 0 hasta que se desencadena un proceso de
        infección e inflamación. Este también es el caso de los leucocitos y
        neutrófilos que son células del sistema inmune cuyos niveles normalmente
        se encuentran bajos si no hay un ataque al sistema por parte de virus,
        bacterias, heridas, etc.</p>
        <p>En resumidas cuentas, la forma de la distribución de estos parámetros
        nos indica los <strong>niveles normales de un parámetro en una población
        y cuales son los niveles que asociamos a condiciones, enfermedades u
        anomalías en general</strong>. Ahora podíamos comprobar y hacer una
        relación entre nuestros pacientes con cáncer de mama y los parámetros
        bioquímicos obtenidos (buscando aquellos que se distanciasen de la moda
        de sus respectivas distribuciones) para buscar <strong>posibles
        marcadores</strong>.</p>
      </div>
      
      <div id="tarea-3-mapea-todos-los-valores-de-expresión-de-genes" class="section level3">
        <h3>Tarea 3: Mapeo de valores de expresión de genes (Heatmap)</h3>
        <p>En esta ultima tarea nos proponemos visualizar mediante un heatmap la
        expresión de los datos crudos de todas las variables AQ que corresponden
        a la expresión de los 30 genes estudiados en los pacientes. En un
        principio decidimos usar la librería de pheatmap, pero consideramos que
        ComplexHeatmap es una herramienta más versátil y que genera unos
        gráficos más completos y mejores visualmente.</p>
        <pre><code class="r">datos_aq &lt;- data_gene %&gt;%
    select(starts_with("AQ_"))
  
  # Escalamos los datos para que tengan media 0 y desviación estándar 1 (normalización).
  datos_aq_scaled &lt;- scale(datos_aq)
  
  rownames(datos_aq_scaled) &lt;- data_gene$id
  
  # Transponemos la matriz para que quede (Genes x Pacientes) como se indica en el enunciado
  datos_final_heatmap &lt;- t(datos_aq_scaled)
  
  library(ComplexHeatmap)
  
  set.seed(1995)
  
  Heatmap(
    datos_final_heatmap,
    
    name = "Nivel de expresión",
    
    column_title = "Heatmap de Expresión Génica en 65 Pacientes",
    column_title_gp = gpar(fontsize = 20),
    
    row_km = 3,
    column_km = 2, 
  
    #Tamaño de las separaciones
    column_gap = unit(5, "mm"), 
    row_gap = unit(3, "mm"), 
    
    column_dend_gp = gpar(col = "grey20", lwd = 3),
    row_dend_gp = gpar(col = "grey20", lwd = 3),    
    
  
    row_names_gp = gpar(fontsize = 17),
    column_names_gp = gpar(fontsize = 13),
    
    show_row_names = TRUE,
    show_column_names = TRUE,
    
    row_labels = toupper(gsub("AQ_", "", rownames(datos_final_heatmap))) 
  )</code></pre>
        
        <figure class="r-plot-figure">
          <img src="img3.jpg" alt="Fig. 3: Heatmap de Expresión Génica">
          <figcaption><em>Fig. 3: Heatmap que muestra la expresión de los 30 genes estudiados
          en nuestra población de 65 pacientes.</em></figcaption>
        </figure>

        <p>En primer lugar, podemos ver que existen tres grandes grupos o
        clusters de genes según su patrón de expresión en la población
        estudiada. En este análisis iremos por partes y nos centraremos uno por
        uno en cada uno de estos clusters.</p>
        <p>El primer cluster (1 a la izquierda del heatmap) que nos encontramos
        está conformado por los genes desde CDH1 hasta FOXA1 en el heatmap. Es
        un claster que equivale a los genes analizados en la Tarea 1. Dentro de
        este cluster podemos encontrar tres grupos de pacientes, un grupo cuya
        expresión de estos genes es muy alta (entre 2 y 1 en el heatmap) que es
        encuentra coloreado de rojo (pacientes de izquierda a derecha del 26-13
        y 21-48). Nos referiremos a este grupo a partir de ahora como A1
        (A=alto, 1=cluster 1). Después no encontramos un grupo con expresión
        media (a partir de ahora M1) cuyos valores oscilan entre 1 y 0 y está
        coloreado de un rojo claro casi blanco (pacientes de 10-23 y 17-51). Por
        último, tenemos un grupo cuyos niveles de expresión son muy bajos, en
        torno al -1. Está coloreado de azul claro (el resto de pacientes) y nos
        referiremos a él como B1.</p>
        <p>De la misma forma y con el mismo sistema de nomenclatura podemos
        referirnos a los grupos de pacientes que nos encontramos en el cluster
        de genes 2 (del gen EGFR al TNF). El grupo A2 comprende los pacientes
        del 26 al 28 y del 21 al 48 y tienen una alta expresión. El resto, el
        grupo B2 tiene muestra una expresión baja.</p>
        <p>Por último, tenemos el cluster 3 (Del gen MYC al HLAA) que se
        encuentra abajo del todo y está dividido en un grupo de pacientes con
        baja expresión de los genes (B3) que comprende desde el paciente 26
        hasta el 56; y un grupo de alta expresión (A3) que comprende desde el
        paciente 21 hasta el 4.</p>
        <p>Teniendo todo esto estructurado podemos ver ciertos patrones incluso
        entre clústeres de genes y grupos de pacientes. Podemos observar que
        <strong>los clusters 1 y 2 están más relacionados entre sí que con el
        cluster 3</strong>. Esto se puede ver tanto atendiendo a las ramas del
        lateral izquierdo como atendiendo al hecho de que los pacientes
        pertenecientes el grupo A1 siempre pertenecen al grupo A2, mientras que
        los que pertenecen al M1 siempre pertenecen al B2. Es decir, parece
        haber una <strong>correlación entre alta expresión de los genes del
        cluster 2 con una alta expresión de los genes del cluster 1</strong> y,
        por otro lado, <strong>una baja expresión de los genes del cluster 2 con
        una expresión media de los genes del cluster 1</strong>. Los genes del
        cluster 3 no <strong>parecen tener este tipo de correlación con respecto
        a los de otros clusters</strong>.</p>
      </div>
      </div>
     </div> 
    <section>
      <h3 class="section-subtitle">Enlaces</h3>
      <div class="links-container">
        
        <a
          href="https://github.com/Alex-PH-Lau/Alex-PH-Lau.github.io/blob/main/proyectos/master/estadistica/Actividad-1-Alex.html"
          target="_blank"
          rel="noopener noreferrer"
          class="link-card"
        >
          <i class="fab fa-github" aria-hidden="true"></i>
          <span>Ver en GitHub</span>
        </a>
      </div>
    </section>
  </main>

  <footer>
    <p>© 2025 Alejandro Pascual Hernández. Hecho en HTML/CSS/JS.</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/r.min.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      document.querySelectorAll('pre code').forEach((el) => {
        hljs.highlightElement(el);
      });
    });
  </script>
  
  <script src="../../../script.js"></script>
</body>
</html>
